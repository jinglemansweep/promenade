# Simple Prometheus Dashboard Example
# Minimal configuration with basic metrics

title: "Home Lab"
refresh_interval: 30  # Refresh all metrics every 10 seconds
grid_rows: 5
grid_columns: 6

widgets:

  # ROW 0

  - label: "UDM SE"
    query: probe_success{instance="10.1.1.1"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 0
    column: 0
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "Switch Rack"
    query: probe_success{instance="10.1.1.11"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 0
    column: 1
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "Switch Lounge"
    query: probe_success{instance="10.1.1.12"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 0
    column: 2
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "WAN Download"
    type: sparkline
    query: homeassistant_sensor_data_rate_mbit_per_s{entity="sensor.speedtest_download"}
    format_string: "{value:.2f} Mbit/s"
    sparkline_summary: mean
    row: 0
    column: 3
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value >= 500"
        border_color: "$success"
      - condition: "value < 500"
        border_color: "$error"

  - label: "WAN Upload"
    type: sparkline
    query: homeassistant_sensor_data_rate_mbit_per_s{entity="sensor.speedtest_upload"}
    format_string: "{value:.2f} Mbit/s"
    sparkline_summary: mean
    row: 0
    column: 4
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value >= 500"
        border_color: "$success"
      - condition: "value < 500"
        border_color: "$error"

  - label: "NAS Volume"
    type: progress
    query: homeassistant_sensor_unit_percent{entity="sensor.ds920plus_volume_used"}
    format_string: "{value:.1f}%"
    show_percentage: true
    row: 0
    column: 5
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value <= 80"
        border_color: "$success"
      - condition: "value > 80"
        border_color: "$error"

  # ROW 1

  - label: "DS920+"
    query: probe_success{instance="ds920p.adm.ptre.es"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 1
    column: 0
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "PVM1"
    query: probe_success{instance="pvm1.adm.ptre.es"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 1
    column: 1
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "PVM2"
    query: probe_success{instance="pvm2.adm.ptre.es"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 1
    column: 2
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "PVM3"
    query: probe_success{instance="pvm3.adm.ptre.es"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 1
    column: 3
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "Jetson"
    query: probe_success{instance="jetson.adm.ptre.es"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 1
    column: 4
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "Dev"
    query: probe_success{instance="dev.adm.ptre.es"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 1
    column: 5 
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  # ROW 2

  - label: "Decks"
    query: probe_success{instance="decks.adm.ptre.es"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 2
    column: 0
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "WideBoy"
    query: probe_success{instance="wideboy.adm.ptre.es"}
    format_string: "'ICMP OK' if value else 'ICMP FAIL'"
    row: 2
    column: 1
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  # ROW 3

  # ROW 4

  - label: "Home Assistant"
    query: probe_success{instance="http://hass.adm.ptre.es:8123"}
    format_string: "'HTTP OK' if value else 'HTTP FAIL {value}'"
    row: 4
    column: 0
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "Plex"
    query: probe_success{instance="http://plex.adm.ptre.es:32400"}
    format_string: "'HTTP OK' if value else 'HTTP FAIL'"
    row: 4
    column: 1
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value == 1"
        border_color: "$success"
      - condition: "value == 0"
        border_color: "$error"

  - label: "DW1 Load Avg"
    type: sparkline
    query: node_load1{instance="dw1.svc.ptre.es:9100"}
    format_string: "{value:.2f}"
    sparkline_summary: mean
    row: 4
    column: 5
    row_span: 1
    column_span: 1
    conditional_formats:
      - condition: "value > 1"
        border_color: "$error"
      - condition: "value <= 1"
        border_color: "$success"
